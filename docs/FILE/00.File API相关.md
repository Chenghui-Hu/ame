---
title: File API相关
date: 2020-07-14 10:02:37
permalink: /pages/e3f50d/
categories: 

    - FILE

tags:

    -

---

## FileList

> 一个 ` FileList ` 对象通常来自于一个 `input` 元素的 `files` 属性，你可以通过这个对象访问到用户所选择的文件。该类型的对象还有可能来自用户的拖放操作。它在结构上类似于数组，包含用户选取的多个文件。如果 `file` 控件没有设置 `multiple` 属性， `FileList` 对象将只有一个元素了。

:::warning
一般来说，我们不可能手动构造 FileList 对象，只能被动地读取，也就是说只有用户主动触发了文件读取行为，js 才能访问到 FileList。
:::

### 选取文件时

``` html
<input id="myfileinput" type='file' multiple />
```

``` javascript
document.querySelector('input').onchange = function() {
    console.log(this.files);
};
// 或
var fileInput = document.getElementById("myfileinput");
// files 是一个 FileList 对象(类似于NodeList对象)
var files = fileInput.files;
console.log(files);
```

控制台将打印

``` javascript
FileList {
    0: File,
    1: File,
    length: 2
}
0: File
1: File
length: 2
__proto__: Object
```

遍历 FileList 获取每一个文件

> `length` 属性：用来返回 `FileList` 中的文件数量。

> `item()` 方法：根据给定的索引值，返回 `FileList` 对象中对应的 `File` 对象。

``` javascript
// 遍历所有文件
for (var i = 0; i < files.length; i++) {
    // 取得一个文件
    file = files.item(i);
    // 这样也行
    file = files[i];
    // 取得文件名
    console.log(file.name);
}
```

### 拖拽文件时

``` html
<textarea></textarea>
```

``` javascript
  var ipt = document.querySelector('textarea');
  ipt.ondragover = function() {
      return false;
  };

  // Add drop handler
  ipt.ondrop = function(e) {
      e.stopPropagation();
      e.preventDefault();
      e = e || window.event;
      var files = e.dataTransfer.files;

      console.log(files); //FileList 对象
  };
```

## File

文件（**`File`**）接口提供有关文件的信息，并允许网页中的 JavaScript 访问其内容。

一个File对象通常具有以下属性

- name：文件名，该属性只读。
- size：文件大小，单位为字节，该属性只读。
- type：文件的 MIME 类型，如果分辨不出类型，则为空字符串，该属性只读。
- lastModified：文件的上次修改时间，格式为时间戳。
- lastModifiedDate：文件的上次修改时间，格式为 Date 对象实例。